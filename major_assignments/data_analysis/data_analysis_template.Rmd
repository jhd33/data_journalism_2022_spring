---
title: "data_analysis_project"
author: "Jon Donville,Varun Shankar, Mythili Devarakonda"
date: "16/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(janitor)
library(tidycensus)
library(stringr)
library(lubridate)
```


## Read in data 

```{r}
marvel_data <- read_csv("data/marvel-wikia-data.csv")
dc_data <- read_csv("data/dc-wikia-data.csv")
```

## Exploratory analysis

1) Marvel Data

The marvel_data dataset consists of 16,376 rows and 13 columns of data on Marvel comic characters. In such a large dataset, only about 90 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}
glimpse(marvel_data)
marvel_data %>% filter (! is.na (GSM))
```

2) DC Data

The dc_data dataset consists of 6,896 rows and 13 columns of data on DC comic characters. In such a large dataset, only about 64 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}
glimpse(dc_data)
dc_data %>% filter (! is.na (GSM))
```
```{r}
# Create an if/else statement to create new columns that group characters into LGBT or not, and neutral color hair or not.
dc_data_lgbt <- dc_data %>%  
mutate(
    lgbt_or_not = case_when(
        GSM == 'Bisexual Characters' ~ "LGBT",
        GSM == 'Homosexual Characters' ~ "LGBT",
      )
  ) %>% 
  mutate(lgbt_or_not = replace_na(lgbt_or_not, "Not LGBT"))
dc_data_lgbt_hair <- dc_data_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        HAIR == 'Black Hair' ~ "NEUTRAL",
        HAIR == 'Blond Hair' ~ "NEUTRAL",
        HAIR == 'Brown Hair' ~ "NEUTRAL",
        HAIR == 'Auburn Hair' ~ "NEUTRAL", 
        HAIR == 'Bald' ~ "NEUTRAL",
        HAIR == 'Green Hair' ~ "Not",
        HAIR == 'Blue Hair' ~ "Not",
        HAIR == 'Gold Hair' ~ "Not", 
        HAIR == 'Grey Hair' ~ "NEUTRAL",
        HAIR == 'Orange Hair' ~ "Not",
        HAIR == 'Pink Hair' ~ "Not",
        HAIR == 'Platinum Blond Hair' ~ "NEUTRAL", 
        HAIR == 'Purple Hair' ~ "Not",
        HAIR == 'Red Hair' ~ "Not",
        HAIR == 'Reddish Brown Hair' ~ "Neutral",
          HAIR == 'Silver Hair' ~ "Not", 
        HAIR == 'Strawberry Blond Hair' ~ "NEUTRAL",
        HAIR == 'Violet Hair' ~ "Not",
        HAIR == 'White Hair' ~ "Not",
        
      )
  ) 
## Same thing for Marvel Data
marvel_data_lgbt <- marvel_data %>%  
mutate(
    lgbt_or_not = case_when(
        GSM == 'Bisexual Characters' ~ "LGBT",
        GSM == 'Homosexual Characters' ~ "LGBT",
      )
  ) %>% 
  mutate(lgbt_or_not = replace_na(lgbt_or_not, "Not LGBT"))
marvel_data_lgbt_hair <- marvel_data_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        HAIR == 'Black Hair' ~ "NEUTRAL",
        HAIR == 'Blond Hair' ~ "NEUTRAL",
        HAIR == 'Brown Hair' ~ "NEUTRAL",
        HAIR == 'Auburn Hair' ~ "NEUTRAL", 
        HAIR == 'Bald' ~ "NEUTRAL",
        HAIR == 'Green Hair' ~ "Not",
        HAIR == 'Blue Hair' ~ "Not",
        HAIR == 'Gold Hair' ~ "Not", 
        HAIR == 'Grey Hair' ~ "NEUTRAL",
        HAIR == 'Orange Hair' ~ "Not",
        HAIR == 'Pink Hair' ~ "Not",
        HAIR == 'Platinum Blond Hair' ~ "NEUTRAL", 
        HAIR == 'Purple Hair' ~ "Not",
        HAIR == 'Red Hair' ~ "Not",
        HAIR == 'Reddish Brown Hair' ~ "Neutral",
          HAIR == 'Silver Hair' ~ "Not", 
        HAIR == 'Strawberry Blond Hair' ~ "NEUTRAL",
        HAIR == 'Violet Hair' ~ "Not",
        HAIR == 'White Hair' ~ "Not",
        
      )
  ) 
```

Question 1: 

```{r}
lgbt_dc_characters_overoneapp <- dc_data_lgbt %>% 
    filter(lgbt_or_not == "LGBT" & APPEARANCES > 1)
lgbt_marvel_characters_overoneapp <- marvel_data_lgbt %>% 
    filter(lgbt_or_not == "LGBT" & APPEARANCES > 1)


 lgbt_dc_characters <- dc_data_lgbt %>% 
    filter(lgbt_or_not == "LGBT")
 lgbt_marvel_characters <- marvel_data_lgbt %>% 
    filter(lgbt_or_not == "LGBT")

 dclgbtcount = count(lgbt_dc_characters)
 dclgbtcountoveroneapp = count(lgbt_dc_characters_overoneapp)
 marvellgbtcount = count(lgbt_marvel_characters)
 marvellgbtcountoveroneapp = count(lgbt_marvel_characters_overoneapp)
 
 
 ((dclgbtcountoveroneapp+marvellgbtcountoveroneapp)/(marvellgbtcount+dclgbtcount))*100
             
```
Question 2: 

```{r}
dc_lgbt_heroes <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")

marvel_lgbt_heroes <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")

dclgbtcountgoodguy = count(dc_lgbt_heroes)
marvellgbtcountgoodguy = count(marvel_lgbt_heroes)
 dclgbtcount = count(lgbt_dc_characters)
 marvellgbtcount = count(lgbt_marvel_characters)
 
  ((dclgbtcountgoodguy+marvellgbtcountgoodguy)/(marvellgbtcount+dclgbtcount))*100
```

Question 4: 

```{r}
dc_lgbt_alive <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")

marvel_lgbt_alive <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")

dclgbtcountalive= count(dc_lgbt_alive)
marvellgbtcountalive = count(marvel_lgbt_alive)

((dclgbtcountalive+marvellgbtcountalive)/(marvellgbtcount+dclgbtcount))*100


```